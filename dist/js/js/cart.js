!function(){if($.cookie("sid")&&$.cookie("num")){var c=$.cookie("sid").split(","),t=$.cookie("num").split(",");$.each(c,function(i,n){!function(t,o){$.ajax({url:"http://10.31.163.74/homework/projectname/project/php/index-returndata.php",dataType:"json"}).done(function(i){$.each(i,function(i,n){if(t==n.sid){var c=$(".shop-car-box:hidden").clone(!0,!0);c.find(".car-pic-left").find("img").attr({src:n.url,sid:t}),c.find(".car-pic-right").find("a").html(n.title),c.find(".car-pir").find("i").html(n.price),c.find(".car-num").find(".car-num-box").html(o),c.find(".car-money").find("i").html((n.price*o).toFixed(2)),c.css("display","block"),$("#shop").append(c)}})})}(c[i],t[i])})}var i=$(".num-right"),n=$(".num-left"),o=0;i.on("click",function(){var i=$(this).parent().find(".car-num-box").html();i++,$(this).parent().find(".car-num-box").html(i),o=$(this).parent().prev().find(" i").html()*i,$(this).parent().next().find("i").html(o),e($(this))}),n.on("click",function(){var i=$(this).parent().find(".car-num-box").html();1<=--i?($(this).parent().find(".car-num-box").html(i),o=$(this).parent().prev().find(" i").html()*i):(i=1,$(this).parent().find(".car-num-box").html(i)),$(this).parent().next().find("i").html(o),e($(this))});c=[],t=[];function r(){$.cookie("sid")&&$.cookie("num")&&(c=$.cookie("sid").split(","),t=$.cookie("num").split(","))}function e(i){r();var n=i.parents(".shop-car-box:visible").find(".car-pic img").attr("sid");t[$.inArray(n,c)]=i.parents(".shop-car-box").find(".car-num .car-num-box").html(),$.cookie("num",t.toString(),7)}$(".allsel").on("click",function(){$(".allsel").prop("checked")?$(".shop-car-box .car-chk input").prop("checked",!0):$(".shop-car-box .car-chk input").prop("checked",!1)}),$(".shop-car-box").on("change",function(){$(".shop-car-box:visible .car-chk input:checked").length==$(".shop-car-box:visible .car-chk input").length?$(".allsel").prop("checked",!0):$(".allsel").prop("checked",!1)}),$(".car-del").on("click",function(){if(r(),confirm("你确定要删除吗？")){$(this).parents(".shop-car-box").remove();var i=$(this).parents(".shop-car-box").find(".car-pic").find("img").attr("sid");t.splice($.inArray(i,c),1),c.splice($.inArray(i,c),1),$.cookie("num",t,7),$.cookie("sid",c,7)}})}();